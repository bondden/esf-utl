{"version":3,"sources":["index.es7.js"],"names":[],"mappings":"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","file":"index.es7.js","sourcesContent":["/**\n * Created by Denis Bondarenko <bond.den@gmail.com> on 25.05.2015.\n */\n\n'use strict';\nvar\n  clc =require('cli-color'),\n  fs  =require('fs'),\n  path=require('path'),\n  os  =require('os'),\n  cirJsn    =require('circular-json')\n;\n\nexport class Utl {\n\n  static styles={\n    'ne': clc.white,\n    'er': clc.red,\n    'ok': clc.green,\n    'em': clc.yellow,\n    'erb':clc.redBright,\n    'sh': clc.whiteBright,\n\n    'b':  clc.blue,\n    'bb': clc.blueBright,\n    'y':  clc.yellow,\n    'yb': clc.yellowBright,\n    'g':  clc.green,\n    'gb': clc.greenBright,\n    'c':  clc.cyan,\n    'cb': clc.cyanBright,\n    'm':  clc.magenta,\n    'mb': clc.magentaBright,\n    'r':  clc.red,\n    'rb': clc.redBright,\n    'w':  clc.white,\n    'wb': clc.whiteBright\n  };\n\n  /**\n   * FFS = for file system\n   * @return string: current Date-Time formatted like 0000-00-00_00-00-00\n   */\n  static getCurrentDateFmtFFS=function(){\n    //add zero\n    function aZ(v){\n      return (v<10)?`0${v}`:v;\n    }\n\n    let d=new Date();\n    return d.getFullYear()+'-'+aZ(d.getMonth()+1)+'-'+aZ(d.getDate())+'_'+aZ(d.getHours())+'-'+aZ(d.getMinutes())+'-'+aZ(d.getSeconds());\n  };\n\n  static stripSlash=function(pathName){\n    return pathName.replace(/\\/+$/,'');\n  };\n\n\t/**\n\t * Transforms a path string to absolute relatively __dirname or dirname + additional `rel` path\n\t * @param {String} p - a path string to be transformed\n\t * @param {String} [rel] - additional relative path between the __dirname of context and `p`\n\t * @returns {String} - absolute path\n   */\n  static absolutizePath=function(p,rel=''){\n    if(!path.isAbsolute(p)){\n      p=path.resolve(__dirname+rel+p).replace(/\\\\/ig,'/');\n    }\n    return p;\n  };\n\n\t/**\n\t * Filters out sensitive information from log, using key names\n\t * @param {String} s\n\t * @returns {*}\n   */\n  static logFilter=function(s){\n    var\n      censorNote  ='FILTERED',\n      censoredKeys=[\n        'pass',\n        'password',\n        'userPass',\n        'userPassword',\n        'token'\n      ]\n    ;\n\n    for(var i=0,l=censoredKeys.length; i<l; i++){\n      s=(s+'').replace(\n        new RegExp('\"'+censoredKeys[i]+'\"\\s*:\\s*\"([^\"]+)\"',\"ig\"),\n        '\"'+censoredKeys[i]+'\":\"'+censorNote+'\"'\n      );\n    }\n\n    return s;\n  };\n\n  static log=function(msg='\\n',style='ne',silent=false){\n\n    //todo: transfer settings to log for a) defining a log file, b) setting logging on/off\n    //todo: clearLog method\n    //if(!settings.log)return; //\n\n    var apx=false;\n\n    //set console style style\n    if(msg instanceof Error){\n      style='er';\n      apx  ='\\n'+msg.stack;\n    }\n\n    //set log format\n    if(typeof msg==='object'){\n      msg=JSON.stringify(msg,null,'\\t');\n      if(apx){\n        msg+=apx;\n      }\n    }\n\n    msg=Utl.logFilter(msg);\n\n    var d=new Date();\n\n    fs.appendFile(\n      path.resolve(os.tmpdir()+'/esfmod.log'),\n      d.toUTCString()+'\\t'+msg+'\\n',\n      function(err){\n        if(err) throw err;\n      }\n    );\n\n    if(!silent){\n      console.log(Utl.styles[style]('\\nesfmod.log: '+msg));\n    }\n\n  };\n\n\t/**\n\t * Universal ESF-projects-wide Promises error handler\n\t * @param {number|string} num - error number\n\t * @param {string}        msg - custom message\n\t * @param {Error}         err - custom error object\n\t * @param {function}      rej - Promise reject handler function\n\t * @param {boolean}       thr - throw: if true - then let throw the Error, set with above params\n\t * @returns {Error}\n   */\n  static rejectingError(\n    num = 0,\n    msg = '',\n    err = null,\n    rej = null,\n    thr = false\n  ){\n\n    if(msg){\n      msg=': '+msg+'\\n';\n    }else{\n      msg='\\n';\n    }\n\n    let sfx='';\n    if(err){\n      sfx=JSON.stringify(err,null,'\\t')+'\\n'+JSON.stringify(err.stack,null,'\\t');\n    }\n\n    msg='Error '+__filename+' #'+num+' '+msg+': '+sfx;\n\n    Utl.log(msg,'er');\n\n    err=new Error(msg);\n\n    if(rej){\n      rej(err);\n    }\n\n    if(thr){\n      throw err;\n    }\n\n    return err;\n\n  }\n\n\t/**\n\t * Capitalizes the first letter of a string\n\t * @param {string} s - a string\n\t * @returns {string|*}\n   */\n  static capitalize(s){\n    s=s.toLowerCase();\n    let a=s.split(/[^a-zA-Z0-9]+/g);\n    a=a.map((v)=>{\n      let aa=v.split('');\n      aa[0]=aa[0].toUpperCase();\n      return aa.join('');\n    });\n    s=a.join('');\n    return s;\n  }\n\n\t/**\n\t * Stringifies an object, stripping off circular structures\n\t * Wrapper over circular-json with preset ESF formatting style\n\t * @param {object|*} o\n\t * @returns {string}\n   */\n\tstatic stringifyJSON(o){\n\t\treturn cirJsn.stringify(o,null,'  ','[Circular]');\n\t}\n\n}\n"],"sourceRoot":"/source/"}